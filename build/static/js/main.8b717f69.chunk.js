(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(e,t,a){e.exports=a(38)},37:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(2),i=a.n(n),o=a(23),s=a.n(o),r=a(25),l=a(11),c=a(6),u=a(7),m=a(9),d=a(8),p=a(10),h=a(13),f=a.n(h),v=a(20),g="https://geocoder.api.here.com/6.2/geocode.json?app_id=".concat("25rKT2MgLyrJ93e8JHFe","&app_code=").concat("J8nLFDmQ2O7pg7GCv3fsKw"),b={getCoordinates:function(){var e=Object(v.a)(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(g,"&searchtext=").concat(t),e.next=3,fetch(a).then(function(e){return e.json()}).then(function(e){if(0===e.Response.View.length)return null;var t=e.Response.View[0].Result[0].Location.DisplayPosition;return{latitude:t.Latitude,longitude:t.Longitude}}).catch(function(e){return null});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getMatrixDistances:function(){var e=Object(v.a)(f.a.mark(function e(){var t,a,n,i,o,s,r=arguments;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],a=r.length>1&&void 0!==r[1]?r[1]:[],n=t.join(",")+";",i=a.join(",")+"?",o="".concat("https://api.mapbox.com/directions-matrix/v1/mapbox/driving/").concat(n).concat(i,"sources=0&annotations=distance&access_token=").concat("pk.eyJ1Ijoic3RlZmFuaGsiLCJhIjoiY2pwYjlxYzcyMHR4ajNrcGQwZDg5MDNmZiJ9.BjjB03ETQJHxvnLezVyPvA"),e.next=7,fetch(o).then(function(e){return e.json()}).then(function(e){return e.distances?e.distances[0].slice(1).map(function(e){return e/1609.344})[0]:null}).catch(function(e){return null});case 7:return s=e.sent,e.abrupt("return",s);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()};function y(e){var t=e.locationKeys.map(function(e,t){return i.a.createElement("option",{key:t,value:e},e.toUpperCase())});return i.a.createElement("div",{className:"list__filter"},i.a.createElement("label",{className:"filter__label",htmlFor:"filter"},"Filter by location:"),i.a.createElement("select",{className:"filter__select",name:"filter",id:"filter",value:e.filterKey,onChange:e.onFilterTaskLocations},i.a.createElement("option",{value:"All"},"ALL TASKS"),t),i.a.createElement("label",{className:"filter__label",htmlFor:"distance"},"Only show markers within\xa0",i.a.createElement("select",{className:"filter__select",name:"distance",id:"distance",value:e.filterDist,onChange:e.onFilterDistLocations},i.a.createElement("option",{value:"99999"}),i.a.createElement("option",{value:"5"},"5"),i.a.createElement("option",{value:"10"},"10"),i.a.createElement("option",{value:"25"},"25"),i.a.createElement("option",{value:"50"},"50"),i.a.createElement("option",{value:"100"},"100")),"\xa0miles"))}var E={address:"",location:"",text:"",coordinates:[],distance:""},_=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).isValidItem=function(){return""!==a.state.temp_item.text.trim()&&""!==a.state.temp_item.location.trim()&&""!==a.state.temp_item.address.trim()},a.handleSubmit=function(e){if(e.preventDefault(),a.isValidItem()){var t=Object(l.a)({},a.state.temp_item,{key:Date.now(),address:a.state.temp_item.address.trim().toLowerCase(),location:a.state.temp_item.location.trim().toLowerCase(),text:a.state.temp_item.text.trim().toLowerCase()});b.getCoordinates(t.address).then(function(e){t.coordinates=e;var n=[t.coordinates.longitude,t.coordinates.latitude],i=[a.props.user.longitude,a.props.user.latitude];b.getMatrixDistances(i,n).then(function(e){t.distance=e}).catch(function(e){console.log(e.message)}),a.props.onAddItem(t)}).catch(function(e){console.log(e.message)}),a.setState({temp_item:E,isValid:!0})}else a.setState({isValid:!1})},a.handleInput=function(e){var t=Object(l.a)({},a.state.temp_item);t[e.target.name]=e.target.value,a.setState({temp_item:t})},a.state={temp_item:E,isValid:!0},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"list-input"},i.a.createElement("div",{className:"list-header"},i.a.createElement("p",null,i.a.createElement("em",null,"All fields required.")),i.a.createElement("form",{className:"list-form",onSubmit:this.handleSubmit},i.a.createElement("input",{className:"form-control mb-1",type:"text",placeholder:"Task (eg, Get Groceries)",name:"text",value:this.state.temp_item.text,onChange:this.handleInput}),i.a.createElement("input",{className:"form-control mb-1",type:"text",placeholder:"Location (eg, Supermarket)",name:"location",value:this.state.temp_item.location,onChange:this.handleInput}),i.a.createElement("input",{className:"form-control mb-1",type:"text",placeholder:"Address (eg 123 Fake Street, Knoxville, TN 37912)",name:"address",value:this.state.temp_item.address,onChange:this.handleInput}),i.a.createElement("button",{type:"submit",className:"btn btn-secondary"},"Add Task")),!this.state.isValid&&i.a.createElement("p",{className:"error-message"},i.a.createElement("small",null,"*Invalid entry. No empty fields."))),i.a.createElement(y,{locationKeys:this.props.locationKeys,filterKey:this.props.filterKey,filterDist:this.props.filterDist,onFilterTaskLocations:this.props.onFilterTaskLocations,onFilterDistLocations:this.props.onFilterDistLocations}))}}]),t}(n.Component),k=a(17),j=(a(36),{position:"absolute",top:0,left:0,padding:"10px"}),w={latitude:0,longitude:0,zoom:12,width:window.innerWidth,height:window.innerHeight-1},D=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e)))._isMounted=!1,a._updateViewport=function(e){a.setState({viewport:e})},a._renderMarkers=function(e,t){return i.a.createElement(k.a,{key:"marker-".concat(t),latitude:e.latitude,longitude:e.longitude,offsetLeft:.25*-e.latitude,offsetTop:.75*-e.latitude},i.a.createElement("i",{className:"fas fa-map-pin fa-2x todo-map-marker"}))},a.state={viewport:w,coordinates:[]},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"focusMapOnUserCoordinates",value:function(){var e=this;this._isMounted&&this.props.getUserCoordinates().then(function(t){var a=t.coords.latitude,n=t.coords.longitude;e.setState({viewport:Object(l.a)({},w,{latitude:a,longitude:n})})})}},{key:"render",value:function(){var e=this.state,t=e.viewport,a=e.coordinates;return this.focusMapOnUserCoordinates(),i.a.createElement(k.c,Object.assign({},t,{mapStyle:"mapbox://styles/mapbox/streets-v9",mapboxApiAccessToken:"pk.eyJ1Ijoic3RlZmFuaGsiLCJhIjoiY2pwYjlxYzcyMHR4ajNrcGQwZDg5MDNmZiJ9.BjjB03ETQJHxvnLezVyPvA",onViewportChange:this._updateViewport}),a.map(this._renderMarkers),i.a.createElement("div",{className:"nav",style:j},i.a.createElement(k.b,{onViewportChange:this._updateViewport})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.coordinates!==t.coordinates?{coordinates:e.coordinates}:null}}]),t}(n.Component);function O(e){return i.a.createElement("li",{className:"list-item ".concat(e.classes)},i.a.createElement("input",{type:"checkbox",className:"list__item--child__checkbox",onClick:function(){return e.onDeleteItem(e.item)}}),i.a.createElement("span",{className:"list__item--child__value"},e.item.text))}function C(e){var t=[];for(var a in e.items){var n=e.items[a][0].distance;t.push(i.a.createElement("li",{className:"list__item ".concat(n>e.filterDist?"hidden":""),key:a},i.a.createElement("h5",{className:"list-item__heading"},a.toUpperCase()),i.a.createElement("ul",{className:"list"},e.items[a].map(function(t){return i.a.createElement(O,{classes:"list__item--child",key:t.key,item:t,onDeleteItem:e.onDeleteItem})}))))}return i.a.createElement("ul",{className:"list list--parent"},t)}var x=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).state={hasError:!1},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.state.hasError?i.a.createElement("h1",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(i.a.Component),N=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e)))._isMounted=!1,a.handleAddItem=function(e){var t=Object(l.a)({},e),n=a.state.items;n.hasOwnProperty(e.location)?n[e.location].push(e):n[e.location]=[e],a.setState({items:n,currentItem:t})},a.handleDeleteItem=function(e){var t=Object(l.a)({},a.state.items),n=e.key,i=a.state.items[e.location].filter(function(e){return e.key!==n});0===i.length?delete t[e.location]:t[e.location]=i,a.setState({items:t})},a.handleFilterTaskLocations=function(e){a.setState({filterKey:e.target.value})},a.handleFilterDistLocations=function(e){a.setState({filterDist:e.target.value})},a.getCoordinates=function(e){var t=Object.values(a.state.items).flat(),n=[],i=a.state.filterDist,o=t.filter(function(e){return e.distance<=i}),s=function(e){return{latitude:e.coordinates.latitude,longitude:e.coordinates.longitude}};"All"===e?n=[o].map(function(e){return e.map(s)}).reduce(function(e,t){return e.concat(t)},[]):n=o.filter(function(t){return t.location===e}).map(s);return n},a.state={items:{},filterKey:"All",filterDist:"99999",user:{latitude:null,longitude:null}},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"getUserCoordinates",value:function(){return new Promise(function(e,t){navigator.geolocation.getCurrentPosition(e,t,{enableHighAccuracy:!0})})}},{key:"setUserCoordinatesToState",value:function(e){var t=e.coords.latitude,a=e.coords.longitude;this.setState({user:{latitude:t,longitude:a}})}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this._isMounted&&navigator.geolocation&&this.getUserCoordinates().then(function(t){return e.setUserCoordinatesToState(t)})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e,t,a=this.state.filterKey;if("All"===a)e=Object.assign({},this.state.items),t=this.getCoordinates("All");else if("All"===a||this.state.items[a]){var n={};n[a]=Object(r.a)(this.state.items[a]),e=n,t=this.getCoordinates(a)}else a="All",t=this.getCoordinates("All");return i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:"todo-container"},i.a.createElement(_,{user:this.state.user,coordinates:t,onAddItem:this.handleAddItem,locationKeys:Object.keys(this.state.items),onFilterTaskLocations:this.handleFilterTaskLocations,onFilterDistLocations:this.handleFilterDistLocations,filterKey:this.state.filterKey,filterDist:this.state.filterDist}),i.a.createElement(x,null,i.a.createElement(C,{items:e,filterDist:this.state.filterDist,onDeleteItem:this.handleDeleteItem}))),i.a.createElement("div",{className:"map-container"},i.a.createElement(D,{coordinates:t,getUserCoordinates:this.getUserCoordinates})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(37);s.a.render(i.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[26,1,2]]]);
//# sourceMappingURL=main.8b717f69.chunk.js.map